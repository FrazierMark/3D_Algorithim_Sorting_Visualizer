import"../css/main.css";import{getMergeSortComparisons}from"./MergeSort.js";import{getQuickSortComparisons}from"./QuickSort";import{getBubbleSortComparisons}from"./BubbleSort";import{getHeapSortComparisons}from"./HeapSort";import{getSelectionSortComparisons}from"./SelectionSort";import{getInsertionSortComparisons}from"./InsertionSort";import*as TWEEN from"@tweenjs/tween.js";import*as THREE from"three";import{OrbitControls}from"three/examples/jsm/controls/OrbitControls.js";let speed=100,bars=100;const SECONDARY_COLOR=23134,PRIMARY_COLOR=5242879,PIVOT_COLOR=16776960,mergeSortBtn=document.querySelector(".merge_position"),newArrayBtn=document.querySelector(".new_array_position"),quickSortBtn=document.querySelector(".quick_position"),bubbleSortBtn=document.querySelector(".bubble_position"),heapSortBtn=document.querySelector(".heap_position"),selectionSortBtn=document.querySelector(".selection_position"),insertionSortBtn=document.querySelector(".insertion_position"),speedSlider=document.querySelector(".speed_slider"),amountSlider=document.querySelector(".amount_slider");function speedSliderChange(){speed=this.value}function amountSliderChange(){bars=this.value}function animate(e){requestAnimationFrame(animate),TWEEN.update(e)}insertionSortBtn.addEventListener("click",insertionSort),mergeSortBtn.addEventListener("click",mergeSort),quickSortBtn.addEventListener("click",quickSort),bubbleSortBtn.addEventListener("click",bubbleSort),heapSortBtn.addEventListener("click",heapSort),selectionSortBtn.addEventListener("click",selectionSort),newArrayBtn.addEventListener("click",newArray),speedSlider.addEventListener("input",speedSliderChange),amountSlider.addEventListener("input",amountSliderChange),requestAnimationFrame(animate);const canvas=document.querySelector("canvas.webgl"),scene=new THREE.Scene;window.scene=scene,scene.fog=new THREE.Fog(4293128957,10,50);const dirLight1=new THREE.DirectionalLight(16753920);dirLight1.position.set(1,10,1),scene.add(dirLight1);const dirLight2=new THREE.DirectionalLight(16770276);dirLight2.position.set(-1,3,5),scene.add(dirLight2);const grid=new THREE.GridHelper(500,500,0,0);grid.material.opacity=.2,grid.material.transparent=!0,scene.add(grid);let group=new THREE.Group;scene.add(group),group.position.z=0;let stateArray=[];const globalPlane=new THREE.Plane(new THREE.Vector3(0,10,0),-0);for(let e=0;e<bars;e++){const o=.2,t=randomNumFromInterval(100,1e3);stateArray.push(t);const r=new THREE.BoxGeometry(o,t,o),n=new THREE.MeshStandardMaterial({color:new THREE.Color(0,4,1),side:THREE.DoubleSide,clipShadows:!0}),i=new THREE.Mesh(r,n);i.position.x=(e-Math.floor(bars/2))*(o+.06),i.castShadow=!0,i.receiveShadow=!0,i.userData={index:e+1,intensity:3},i.setColor=function(e){i.material.color.set(e)},group.add(i)}const sizes={width:window.innerWidth,height:window.innerHeight};window.addEventListener("resize",(()=>{sizes.width=window.innerWidth,sizes.height=window.innerHeight,camera.aspect=sizes.width/sizes.height,camera.updateProjectionMatrix(),renderer.setSize(sizes.width,sizes.height),renderer.setPixelRatio(Math.min(window.devicePixelRatio,2))}));const camera=new THREE.PerspectiveCamera(60,sizes.width/sizes.height,.1,2e3);camera.position.x=0,camera.position.y=2,camera.position.z=14,scene.add(camera);const controls=new OrbitControls(camera,canvas);controls.enableDamping=!0;const renderer=new THREE.WebGLRenderer({canvas,antialias:!0});renderer.setSize(sizes.width,sizes.height),renderer.setPixelRatio(Math.min(window.devicePixelRatio,2)),renderer.shadowMap.enabled=!0,renderer.setClearColor(16777215,0),renderer.shadowMap.type=THREE.PCFSoftShadowMap;const globalPlanes=[globalPlane],Empty=Object.freeze([]);renderer.clippingPlanes=globalPlanes,renderer.localClippingEnabled=!0;const clock=new THREE.Clock,tick=()=>{clock.getElapsedTime(),controls.update(),renderer.render(scene,camera),window.requestAnimationFrame(tick)};function randomNumFromInterval(e,o){return Math.floor(Math.random()*(o-e)+e)/100}function mergeSort(){const e=getMergeSortComparisons(stateArray);for(let o=0;o<e.length;o++)if(o%3!=2){const[t,r]=e[o],n=group.children[t],i=group.children[r],s=o%3==0?23134:5242879;setTimeout((()=>{n.setColor(s),i.setColor(s)}),o*speed)}else setTimeout((()=>{const[t,r]=e[o];replaceObjectInGroup(group.children[t].position.x,t,r,group.children[t].userData.index)}),o*speed)}function quickSort(){const e=getQuickSortComparisons(stateArray);for(let o=0;o<e.length;o++)if(o%3!=2){const[t,r,n]=e[o],i=group.children[t],s=group.children[r];let a=Math.round(n);const c=group.children[a],d=o%3==0?23134:5242879;setTimeout((()=>{i.setColor(d),s.setColor(d),c.setColor(16776960)}),o*speed)}else setTimeout((()=>{const[t,r,n]=e[o];let i=group.children[t].position.x,s=group.children[r].position.x;moveObject(i,s,group.children[t]),moveObject(s,i,group.children[r]),swap(group.children,t,r)}),o*speed)}function bubbleSort(){doComparisonsAndSort(getBubbleSortComparisons(stateArray))}function heapSort(){doComparisonsAndSort(getHeapSortComparisons(stateArray))}function selectionSort(){doComparisonsAndSort(getSelectionSortComparisons(stateArray))}function insertionSort(){doComparisonsAndSort(getInsertionSortComparisons(stateArray))}function doComparisonsAndSort(e){for(let o=0;o<e.length;o++)if(o%3!=2){const[t,r]=e[o],n=group.children[t],i=group.children[r],s=o%3==0?23134:5242879;setTimeout((()=>{n.setColor(s),i.setColor(s)}),o*speed)}else setTimeout((()=>{const[t,r]=e[o];let n=group.children[t].position.x,i=group.children[r].position.x;moveObject(n,i,group.children[t]),moveObject(i,n,group.children[r]),swap(group.children,t,r)}),o*speed)}function moveObject(e,o,t){new TWEEN.Tween({x:e}).to({x:o},speed).onUpdate((e=>{t.position.x=e.x})).start()}function swap(e,o,t){var r=e[o];e[o]=e[t],e[t]=r}function replaceObjectInGroup(e,o,t,r){const n=t,i=new THREE.BoxGeometry(.2,n,.2),s=new THREE.MeshStandardMaterial({color:new THREE.Color(0,4,1),side:THREE.DoubleSide,clippingPlanes:[globalPlane],clipShadows:!0}),a=new THREE.Mesh(i,s);a.position.x=e,a.position.z=.5,a.castShadow=!0,a.receiveShadow=!0,a.userData={index:r,intensity:2},a.setColor=function(e){a.material.color.set(e)},group.children.splice(o,1,a)}function newArray(){for(;group.children.length;)group.remove(group.children[0]);stateArray=[];for(let e=0;e<bars;e++){const o=.2,t=randomNumFromInterval(100,1e3);stateArray.push(t);const r=new THREE.BoxGeometry(o,t,o),n=new THREE.MeshStandardMaterial({color:new THREE.Color(0,4,1),flatShading:!0,side:THREE.DoubleSide,clippingPlanes:[globalPlane],clipShadows:!0}),i=new THREE.Mesh(r,n);i.position.x=(e-bars/2)*(o+.06),i.castShadow=!0,i.receiveShadow=!0,i.userData={index:e+1,intensity:3},i.setColor=function(e){i.material.color.set(e)},group.add(i)}}tick();