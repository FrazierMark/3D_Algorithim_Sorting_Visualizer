import"../css/main.css";import{getMergeSortComparisons}from"./MergeSort.js";import{getQuickSortComparisons}from"./QuickSort";import{getBubbleSortComparisons}from"./BubbleSort";import{getHeapSortComparisons}from"./HeapSort";import{getSelectionSortComparisons}from"./SelectionSort";import{getInsertionSortComparisons}from"./InsertionSort";import*as TWEEN from"@tweenjs/tween.js";import*as THREE from"three";import{OrbitControls}from"three/examples/jsm/controls/OrbitControls.js";let speed=100,bars=100;const SECONDARY_COLOR=23134,PRIMARY_COLOR=5242879,PIVOT_COLOR=16776960,mergeSortBtn=document.querySelector(".merge_position"),newArrayBtn=document.querySelector(".new_array_position"),quickSortBtn=document.querySelector(".quick_position"),bubbleSortBtn=document.querySelector(".bubble_position"),heapSortBtn=document.querySelector(".heap_position"),selectionSortBtn=document.querySelector(".selection_position"),insertionSortBtn=document.querySelector(".insertion_position"),speedSlider=document.querySelector(".speed_slider"),amountSlider=document.querySelector(".amount_slider"),allButtons=document.getElementsByTagName("button");function speedSliderChange(){speed=this.value}function amountSliderChange(){bars=this.value}function animate(e){requestAnimationFrame(animate),TWEEN.update(e)}insertionSortBtn.addEventListener("click",insertionSort),mergeSortBtn.addEventListener("click",mergeSort),quickSortBtn.addEventListener("click",quickSort),bubbleSortBtn.addEventListener("click",bubbleSort),heapSortBtn.addEventListener("click",heapSort),selectionSortBtn.addEventListener("click",selectionSort),newArrayBtn.addEventListener("click",newArray),speedSlider.addEventListener("input",speedSliderChange),amountSlider.addEventListener("input",amountSliderChange),requestAnimationFrame(animate);const canvas=document.querySelector("canvas.webgl"),scene=new THREE.Scene;window.scene=scene,scene.fog=new THREE.Fog(4293128957,10,50);const dirLight1=new THREE.DirectionalLight(16753920);dirLight1.position.set(1,10,1),scene.add(dirLight1);const dirLight2=new THREE.DirectionalLight(16770276);dirLight2.position.set(-1,3,5),scene.add(dirLight2);const grid=new THREE.GridHelper(500,500,0,0);grid.material.opacity=.2,grid.material.transparent=!0,scene.add(grid);let group=new THREE.Group;scene.add(group),group.position.z=0;let stateArray=[];const globalPlane=new THREE.Plane(new THREE.Vector3(0,10,0),-0);for(let e=0;e<bars;e++){const t=.2,o=randomNumFromInterval(100,1e3);stateArray.push(o);const r=new THREE.BoxGeometry(t,o,t),n=new THREE.MeshStandardMaterial({color:new THREE.Color(0,4,1),side:THREE.DoubleSide,clipShadows:!0}),i=new THREE.Mesh(r,n);i.position.x=(e-Math.floor(bars/2))*(t+.06),i.castShadow=!0,i.receiveShadow=!0,i.userData={index:e+1,intensity:3},i.setColor=function(e){i.material.color.set(e)},group.add(i)}const sizes={width:window.innerWidth,height:window.innerHeight};window.addEventListener("resize",(()=>{sizes.width=window.innerWidth,sizes.height=window.innerHeight,camera.aspect=sizes.width/sizes.height,camera.updateProjectionMatrix(),renderer.setSize(sizes.width,sizes.height),renderer.setPixelRatio(Math.min(window.devicePixelRatio,2))}));const camera=new THREE.PerspectiveCamera(60,sizes.width/sizes.height,.1,2e3);camera.position.x=0,camera.position.y=2,camera.position.z=14,scene.add(camera);const controls=new OrbitControls(camera,canvas);controls.enableDamping=!0;const renderer=new THREE.WebGLRenderer({canvas,antialias:!0});renderer.setSize(sizes.width,sizes.height),renderer.setPixelRatio(Math.min(window.devicePixelRatio,2)),renderer.shadowMap.enabled=!0,renderer.setClearColor(16777215,0),renderer.shadowMap.type=THREE.PCFSoftShadowMap;const globalPlanes=[globalPlane],Empty=Object.freeze([]);renderer.clippingPlanes=globalPlanes,renderer.localClippingEnabled=!0;const clock=new THREE.Clock,tick=()=>{clock.getElapsedTime(),controls.update(),renderer.render(scene,camera),window.requestAnimationFrame(tick)};function disableAllBtns(){Array.from(document.querySelectorAll("button")).forEach((e=>e.disabled=!0))}function randomNumFromInterval(e,t){return Math.floor(Math.random()*(t-e)+e)/100}function mergeSort(){disableAllBtns();const e=getMergeSortComparisons(stateArray);for(let t=0;t<e.length;t++)if(t%3!=2){const[o,r]=e[t],n=group.children[o],i=group.children[r],s=t%3==0?23134:5242879;setTimeout((()=>{n.setColor(s),i.setColor(s)}),t*speed)}else setTimeout((()=>{const[o,r]=e[t];replaceObjectInGroup(group.children[o].position.x,o,r,group.children[o].userData.index)}),t*speed);setTimeout(onAnimationComplete,e.length*speed)}function onAnimationComplete(){Array.from(document.querySelectorAll("button")).forEach((e=>e.disabled=!1))}function quickSort(){disableAllBtns();const e=getQuickSortComparisons(stateArray);for(let t=0;t<e.length;t++)if(t%3!=2){const[o,r,n]=e[t],i=group.children[o],s=group.children[r];let a=Math.round(n);const l=group.children[a],c=t%3==0?23134:5242879;setTimeout((()=>{i.setColor(c),s.setColor(c),l.setColor(16776960)}),t*speed)}else setTimeout((()=>{const[o,r,n]=e[t];let i=group.children[o].position.x,s=group.children[r].position.x;moveObject(i,s,group.children[o]),moveObject(s,i,group.children[r]),swap(group.children,o,r)}),t*speed);setTimeout(onAnimationComplete,e.length*speed)}function bubbleSort(){doComparisonsAndSort(getBubbleSortComparisons(stateArray))}function heapSort(){doComparisonsAndSort(getHeapSortComparisons(stateArray))}function selectionSort(){doComparisonsAndSort(getSelectionSortComparisons(stateArray))}function insertionSort(){doComparisonsAndSort(getInsertionSortComparisons(stateArray))}function doComparisonsAndSort(e){disableAllBtns();for(let t=0;t<e.length;t++)if(t%3!=2){const[o,r]=e[t],n=group.children[o],i=group.children[r],s=t%3==0?23134:5242879;setTimeout((()=>{n.setColor(s),i.setColor(s)}),t*speed)}else setTimeout((()=>{const[o,r]=e[t];let n=group.children[o].position.x,i=group.children[r].position.x;moveObject(n,i,group.children[o]),moveObject(i,n,group.children[r]),swap(group.children,o,r)}),t*speed);setTimeout(onAnimationComplete,e.length*speed)}function moveObject(e,t,o){new TWEEN.Tween({x:e}).to({x:t},speed).onUpdate((e=>{o.position.x=e.x})).start()}function swap(e,t,o){var r=e[t];e[t]=e[o],e[o]=r}function replaceObjectInGroup(e,t,o,r){const n=o,i=new THREE.BoxGeometry(.2,n,.2),s=new THREE.MeshStandardMaterial({color:new THREE.Color(0,4,1),side:THREE.DoubleSide,clippingPlanes:[globalPlane],clipShadows:!0}),a=new THREE.Mesh(i,s);a.position.x=e,a.position.z=.5,a.castShadow=!0,a.receiveShadow=!0,a.userData={index:r,intensity:2},a.setColor=function(e){a.material.color.set(e)},group.children.splice(t,1,a)}function newArray(){for(;group.children.length;)group.remove(group.children[0]);stateArray=[];for(let e=0;e<bars;e++){const t=.2,o=randomNumFromInterval(100,1e3);stateArray.push(o);const r=new THREE.BoxGeometry(t,o,t),n=new THREE.MeshStandardMaterial({color:new THREE.Color(0,4,1),flatShading:!0,side:THREE.DoubleSide,clippingPlanes:[globalPlane],clipShadows:!0}),i=new THREE.Mesh(r,n);i.position.x=(e-bars/2)*(t+.06),i.castShadow=!0,i.receiveShadow=!0,i.userData={index:e+1,intensity:3},i.setColor=function(e){i.material.color.set(e)},group.add(i)}stopAnimationFlag=!1}tick();